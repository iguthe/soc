<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Análisis de Incidentes — Manual SOC (v3)</title>
<style>
:root{
  --bg:#0b1020;--panel:#121a33;--muted:#98a2b3;--text:#e6e8ef;--chip:#243056;--border:#1d2747;--card:#0f162b;
}
html{scroll-behavior:smooth}
body{margin:0;background:linear-gradient(180deg,#0a0f21,#0b1126);color:var(--text);
  font:14px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,"Helvetica Neue",Arial;}
header{position:sticky;top:0;z-index:100;background:rgba(11,17,38,.85);border-bottom:1px solid var(--border);backdrop-filter:saturate(180%) blur(10px)}
.wrap{max-width:1100px;margin:auto;padding:16px}
h1{margin:8px 0 4px;font-size:22px}
.subtitle{margin:0 0 12px;color:var(--muted)}
.grid{display:grid;grid-template-columns:260px 1fr;gap:16px}
nav{position:sticky;top:86px;align-self:start;background:var(--panel);border:1px solid var(--border);
  border-radius:14px;padding:8px;max-height:calc(100vh - 110px);overflow:auto}
.cat{display:block;padding:10px 12px;border-radius:10px;color:#cdd3ea;text-decoration:none;border:1px solid transparent}
.cat.active,.cat:hover{background:var(--chip);border-color:#2a3864}
main{display:grid;gap:16px}
section{background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:12px}
section h2{margin:6px 6px 8px;font-size:17px;display:flex;justify-content:space-between;align-items:center}
.label{font-size:12px;color:#a0aec0;border:1px solid #2a3864;background:#0f162b;padding:3px 8px;border-radius:8px;margin-left:8px;white-space:nowrap}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px;display:flex;flex-direction:column;gap:4px}
.cmd{font-family:ui-monospace,SFMono-Regular,Menlo,Consolas,monospace}
.desc{color:#a0aec0;font-size:13px}
.btn{align-self:flex-start;border:1px solid var(--border);background:var(--chip);color:#cdd8ff;padding:6px 10px;border-radius:8px;cursor:pointer;font-size:13px}
.btn:hover{border-color:#32406f}
.searchbar{margin-top:8px;margin-bottom:12px}
input[type=search]{width:100%;padding:10px;border-radius:8px;border:1px solid var(--border);background:#0c1430;color:var(--text)}
#topBtn{position:fixed;bottom:25px;right:25px;background:#243056;border:1px solid #32406f;color:#cdd8ff;
  border-radius:50%;width:45px;height:45px;font-size:22px;cursor:pointer;display:none;align-items:center;justify-content:center;transition:0.3s}
#topBtn:hover{background:#32406f}
@media(max-width:900px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<header><div class="wrap">
<h1>Análisis de Incidentes</h1>
<p class="subtitle">Metodología de análisis, identificación de IoC, triage, timeline y análisis forense básico.</p>
<div class="searchbar"><input id="q" type="search" placeholder="Buscar comando o técnica..."></div>
</div></header>
<div class="wrap grid">
<nav id="nav"></nav>
<main id="content"></main>
</div>
<footer style="text-align:center;color:var(--muted);padding:16px">Manual de referencia SOC — Análisis de Incidentes (v3)</footer>
<button id="topBtn" title="Volver arriba">⬆</button>
<script>
const DATA=[
{cat:"Identificación y Triage Inicial",label:"Comandos de Terminal",items:[
{cmd:"who -a",desc:"Lista sesiones y usuarios conectados actualmente."},
{cmd:"last -a | head -20",desc:"Muestra últimos inicios de sesión y su IP/host."},
{cmd:"grep -i 'failed password' /var/log/auth.log",desc:"Busca intentos fallidos de autenticación en Linux."},
{cmd:"journalctl -p 3 -xb",desc:"Errores críticos del último arranque (prioridad 3)."},
{cmd:"netstat -antup",desc:"Conexiones y puertos en escucha con PID/proceso."},
{cmd:"ss -tulpen",desc:"Sockets TCP/UDP en escucha (alternativa moderna a netstat)."},
{cmd:"ps aux --sort=-%mem | head -15",desc:"Top procesos por consumo de memoria."},
{cmd:"top -bn1 | head -20",desc:"Snapshot de CPU/memoria para detectar picos anómalos."},
{cmd:"sudo auditctl -s",desc:"Estado del framework Audit en Linux (auditoría)."},
{cmd:"sudo ausearch -m USER_LOGIN -ts recent",desc:"Eventos recientes de login a través de auditd."}]},
{cat:"Indicadores de Compromiso (IoC)",label:"Comandos de Terminal",items:[
{cmd:"sha256sum archivo",desc:"Calcula SHA256 para verificar en TI (VT/MISP/OTX)."},
{cmd:"md5sum archivo",desc:"Hash MD5 (búsquedas históricas locales/rápidas)."},
{cmd:"grep -R '1.2.3.4' /var/log",desc:"Busca una IP específica en todos los logs."},
{cmd:"grep -R 'example.bad' /var/log",desc:"Busca un dominio sospechoso en registros."},
{cmd:"nslookup dominio.tld",desc:"Resuelve un dominio para revisar IP/autoridad."},
{cmd:"whois dominio.tld",desc:"Consulta WHOIS para contexto de registro/propiedad."},
{cmd:"strings binario | less",desc:"Extrae cadenas legibles de un ejecutable sospechoso."},
{cmd:"file binario",desc:"Identifica tipo y formato de un archivo binario."},
{cmd:"find / -mtime -1 -type f 2>/dev/null",desc:"Archivos modificados en últimas 24h (tampering)."},
{cmd:"lsattr /etc/passwd /etc/shadow",desc:"Detecta atributos inmutables o cambios anómalos."}]},
{cat:"Timeline del Incidente",label:"Comandos de Terminal",items:[
{cmd:"grep -i 'accepted' /var/log/auth.log | awk '{print $1,$2,$3,$9,$11}'",desc:"Autenticaciones exitosas con usuario/IP y timestamp."},
{cmd:"ausearch -ts 12:00:00 -te now -i",desc:"Eventos auditd desde hora específica a ahora (legibles)."},
{cmd:"last -F | head -30",desc:"Inicio/fin de sesiones con timestamps completos."},
{cmd:"journalctl --since '2 hours ago' | less",desc:"Eventos del journal en las últimas 2 horas."},
{cmd:"log2timeline.py evidencia.plaso /mnt/imagen",desc:"Crea timeline forense con Plaso (artefactos múltiples)."},
{cmd:"pslist",desc:"Procesos en análisis en vivo/volcado (suite forense)."},
{cmd:"grep -R 'cron' /var/log | tail -100",desc:"Tareas programadas recientes potencialmente maliciosas."},
{cmd:"stat archivo",desc:"Tiempos MACB (mod/acc/chan/crea) de un archivo."}]},
{cat:"Análisis Forense Básico",label:"Comandos de Terminal",items:[
{cmd:"df -h",desc:"Uso de disco; identifica montajes sospechosos."},
{cmd:"mount",desc:"Sistemas de archivos montados actualmente."},
{cmd:"lsof -nPi",desc:"Sockets abiertos y procesos asociados (red)."},
{cmd:"netstat -plant | grep ESTABLISHED",desc:"Conexiones establecidas con PID."},
{cmd:"chkrootkit",desc:"Escaneo rápido de rootkits comunes."},
{cmd:"rkhunter --check --sk",desc:"Hunter de rootkits/puertas traseras."},
{cmd:"volatility -f mem.raw --profile=Win10x64_19041 pslist",desc:"Procesos desde un volcado de memoria (Windows)."},
{cmd:"volatility -f mem.raw netscan",desc:"Conexiones de red desde un volcado de memoria."},
{cmd:"grep -r '/tmp' /etc/cron*",desc:"Crons apuntando a /tmp (persistencia)."},
{cmd:"find /etc/ -name '*.service' -exec grep -H ExecStart {} \\;",desc:"Servicios systemd con rutas sospechosas."}]}
];
const nav=document.getElementById('nav'),content=document.getElementById('content');
DATA.forEach((s,i)=>{
  const a=document.createElement('a');a.href=`#sec-${i}`;a.textContent=s.cat;a.className='cat';
  if(i===0)a.classList.add('active');
  a.onclick=()=>{document.querySelectorAll('.cat').forEach(x=>x.classList.remove('active'));a.classList.add('active');};
  nav.appendChild(a);
  const sec=document.createElement('section');sec.id=`sec-${i}`;
  const h2=document.createElement('h2');h2.textContent=s.cat;
  const label=document.createElement('span');label.className='label';label.textContent=s.label;h2.append(label);
  sec.append(h2);
  s.items.forEach(it=>{
    const card=document.createElement('div');card.className='card';
    const cmd=document.createElement('div');cmd.className='cmd';cmd.textContent=it.cmd;
    const btn=document.createElement('button');btn.className='btn';btn.textContent='Copiar';
    btn.onclick=()=>{navigator.clipboard.writeText(it.cmd).then(()=>{btn.textContent='Copiado';setTimeout(()=>btn.textContent='Copiar',1200);});};
    const desc=document.createElement('div');desc.className='desc';desc.textContent=it.desc;
    card.append(cmd,btn,desc);sec.appendChild(card);
  });
  content.appendChild(sec);
});
document.getElementById('q').addEventListener('input',e=>{
  const term=e.target.value.toLowerCase();
  document.querySelectorAll('section').forEach(sec=>{
    let visible=false;sec.querySelectorAll('.card').forEach(card=>{
      const match=card.textContent.toLowerCase().includes(term);
      card.style.display=match?'flex':'none';if(match)visible=true;});
    sec.style.display=visible||!term?'block':'none';
  });
});
const topBtn=document.getElementById('topBtn');
window.addEventListener('scroll',()=>{topBtn.style.display=document.documentElement.scrollTop>400?'flex':'none';});
topBtn.addEventListener('click',()=>{window.scrollTo({top:0,behavior:'smooth'});});
</script>
</body>
</html>